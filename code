import sqlite3

conn = sqlite3.connect("atm.db")
cursor = conn.cursor()

print("Enter your card number:")
cnum = input()

cursor.execute("SELECT * FROM users WHERE card_number = ?", (cnum,))
user = cursor.fetchone()

if not user:
    print("Card not found.")
    conn.close()
    exit()

print("Enter your PIN:")
pin = input()

if pin != user[1]:
    print("Incorrect PIN.")
    conn.close()
    exit()

print("Choose an option:")
print("1. Check balance")
print("2. Withdraw money")
print("3. Deposit money")
print("4. Add new account")

choice = int(input("Your choice: "))

if choice == 1:
    print(f"Your balance is: â‚¹{user[2]}")

elif choice == 2:
    amount = int(input("Enter amount to withdraw: "))
    if amount > user[2]:
        print("Insufficient balance.")
    else:
        new_balance = user[2] - amount
        cursor.execute("UPDATE users SET balance = ? WHERE card_number = ?", (new_balance, cnum))
        conn.commit()
        print(f"{amount} withdrawn. New balance: {new_balance}")

elif choice == 3:
    amount = int(input("Enter amount to deposit: "))
    new_balance = user[2] + amount
    cursor.execute("UPDATE users SET balance = ? WHERE card_number = ?", (new_balance, cnum))
    conn.commit()
    print(f"{amount} deposited. New balance: {new_balance}")

elif choice == 4:
    new_card = input("Enter new card number: ")
    new_pin = input("Set PIN: ")
    cursor.execute("INSERT INTO users (card_number, pin) VALUES (?, ?)", (new_card, new_pin))
    conn.commit()
    print("New account created with 0 balance.")

else:
    print("Invalid option.")

conn.close()
